[
  {
    "objectID": "quarto/movement_patterns.html",
    "href": "quarto/movement_patterns.html",
    "title": "Movement Patterns",
    "section": "",
    "text": "In this document, we will examine patterns in the movement behaviours of collared muskoxen. We will use muskox speed and turning angles to explore behaviour.",
    "crumbs": [
      "Movement Patterns"
    ]
  },
  {
    "objectID": "quarto/movement_patterns.html#movement-trends",
    "href": "quarto/movement_patterns.html#movement-trends",
    "title": "Movement Patterns",
    "section": "Movement Trends",
    "text": "Movement Trends\n\n\n\n\n\n\n\n\n\nBased on the time series above, movement tends to be highest in the summer (June, July, August), gradually decrease during autumn (September, October, November) and winter (December, January, February) and experience a sharp increase in the late spring (May). Perhaps this increase is timed with parturition, which has been found to start in April/May (Adamczewski 1997). Alternatively, this could be tied to the timing of snowmelt. We can explore this further by looking at average seasonal step lengths for each muskox:\n\n\n\n\n\n\n\n\n\nStep lengths in the winter and spring are similar, whereas autumn step lengths are intermediate between winter and summer. This again highlights the discrepancy between the gradual decrease in step lengths from summer to winter compared with the sharper increase from winter to summer.\nFor the most part, average seasonal step lengths are consistent between muskoxen, though there appear to be greater variation in the spring and autumn. To examine this further, let’s plot smoothed curves of step lengths against day of year for different years. We’ll restrict this plot to muskoxen-year combinations with more than half a year’s worth of data:\n\n\n\n\n\n\n\n\n\nThe curves of step lengths follow similar trajectories but there is still considerable variation across years and among muskoxen. This suggests weather, landscape, and muskox characteristics may play a part in influencing movement behaviour.",
    "crumbs": [
      "Movement Patterns"
    ]
  },
  {
    "objectID": "quarto/movement_patterns.html#net-squared-displacement",
    "href": "quarto/movement_patterns.html#net-squared-displacement",
    "title": "Movement Patterns",
    "section": "Net Squared Displacement",
    "text": "Net Squared Displacement\nWe can also look at net squared displacement curves to investigate movement patterns of muskoxen (i.e. resident, migratory, or nomadic). See Bunnefeld et al. (2011) for examples of how these curves look for different movement classes (i.e. migrant, disperser, resident, nomad).\nTo do this we will use the adehabitatLT package to format our data and the migrateR package to fit different models to the net displacement data. Let’s first get our collar data into the trajectory format used by adehabitatLT. We will also subset our data to one observation per day to improve modelling efficiency.\n\nmusk_collar_sub &lt;- musk_collar_filt %&gt;%\n  filter(lubridate::hour(datetime) == 16)\n\nxy &lt;- musk_collar_sub %&gt;%\n  sf::st_transform(\"+proj=utm +zone=9\") %&gt;%\n  sf::st_coordinates()\nltraj &lt;- adehabitatLT::as.ltraj(xy = xy, date = musk_collar_sub$datetime, id = musk_collar_sub$Id_Number)\n\nadehabitatLT::ld(ltraj) %&gt;%\n  filter(!(id %in% c(707,709,710))) %&gt;%\n  ggplot(aes(x = date, y = R2n)) +\n  geom_point(size = 0.5) +\n  geom_line() +\n  ylab(\"Net squared displacement (km^2)\") +\n  xlab(\"Date\") +\n  facet_wrap(~id) +\n  theme_bw() +\n  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))\n\n\n\n\n\n\n\n\nThe plot above shows the net squared displacement from the initial location for each collared muskoxen. There does not appear to be a clear movement behaviour shared between all muskoxen. Most appear to have short periods of time during the summer with large net squared displacement, but these are generally followed by longer periods where net squared displacement is much smaller. Muskoxen 7011 and 7012 show a general increasing trend in net squared displacement, but there are still extended periods of smaller displacement throughout the time series. Most of the periods of larger displacement do not appear to be long enough to represent a separate summer range. Examinations of animations of muskox movements generally show that they tend to move between patches of resources during the summer rather than sticking to one specific area.",
    "crumbs": [
      "Movement Patterns"
    ]
  },
  {
    "objectID": "quarto/movement_patterns.html#spatial-patterns",
    "href": "quarto/movement_patterns.html#spatial-patterns",
    "title": "Movement Patterns",
    "section": "Spatial Patterns",
    "text": "Spatial Patterns"
  },
  {
    "objectID": "quarto/data_exploration.html",
    "href": "quarto/data_exploration.html",
    "title": "Data Cleaning",
    "section": "",
    "text": "Movement data for this project come from 10 female muskoxen in the Sahtu region of the Northwest Territories (NWT) that were collared between December 2007 and February 2012.\nWe can plot the date ranges of individual collared muskoxen below:\n\n\n\n\n\n\nId_Number\nDateRange\nNumDays\n\n\n\n\n706\nDec 2007 to May 2009\n515\n\n\n707\nDec 2007 to Apr 2008\n145\n\n\n708\nFeb 2009 to Dec 2010\n669\n\n\n709\nJan 2008 to Apr 2008\n98\n\n\n710\nJan 2008 to Apr 2008\n100\n\n\n7010\nFeb 2009 to Jan 2010\n345\n\n\n7011\nJan 2009 to Dec 2011\n1055\n\n\n7012\nFeb 2009 to Feb 2012\n1106\n\n\n7013\nFeb 2009 to Aug 2011\n926\n\n\n7080\nDec 2007 to Aug 2009\n607\n\n\n\n\n\n\n\n\nMuskoxen 707, 709, 710, and 7010 have less than a year of movement data and only 7011, 7012, and 7013 have more than 2 years of data.",
    "crumbs": [
      "Data Cleaning"
    ]
  },
  {
    "objectID": "quarto/data_exploration.html#sample-size",
    "href": "quarto/data_exploration.html#sample-size",
    "title": "Data Cleaning",
    "section": "",
    "text": "Movement data for this project come from 10 female muskoxen in the Sahtu region of the Northwest Territories (NWT) that were collared between December 2007 and February 2012.\nWe can plot the date ranges of individual collared muskoxen below:\n\n\n\n\n\n\nId_Number\nDateRange\nNumDays\n\n\n\n\n706\nDec 2007 to May 2009\n515\n\n\n707\nDec 2007 to Apr 2008\n145\n\n\n708\nFeb 2009 to Dec 2010\n669\n\n\n709\nJan 2008 to Apr 2008\n98\n\n\n710\nJan 2008 to Apr 2008\n100\n\n\n7010\nFeb 2009 to Jan 2010\n345\n\n\n7011\nJan 2009 to Dec 2011\n1055\n\n\n7012\nFeb 2009 to Feb 2012\n1106\n\n\n7013\nFeb 2009 to Aug 2011\n926\n\n\n7080\nDec 2007 to Aug 2009\n607\n\n\n\n\n\n\n\n\nMuskoxen 707, 709, 710, and 7010 have less than a year of movement data and only 7011, 7012, and 7013 have more than 2 years of data.",
    "crumbs": [
      "Data Cleaning"
    ]
  },
  {
    "objectID": "quarto/data_exploration.html#collar-failure",
    "href": "quarto/data_exploration.html#collar-failure",
    "title": "Data Cleaning",
    "section": "Collar Failure",
    "text": "Collar Failure\nBefore we look into the data, there are some data cleaning steps we can use to remove errors from that dataset. First, we know that collars 707, 709, and 710 had their release mechanisms triggered early, so we need to look at the data to figure out when this happened. Let’s start by looking at histograms of step lengths:\n\n\n\n\n\n\n\n\n\nThe stepped nature of the distances traveled on the left side of the graph are a result of the resolution of the GPS device. For collars 707, 709, and 710, there appear to be a greater-than-expected number of instances where the muskoxen move negligible distances. By plotting time series of step lengths, we can can see that these negligible distances occur at the end of the recording periods:\n\n\n\n\n\n\n\n\n\nFor simplicity, let’s remove all points following the first two consecutive short step lengths (i.e. 0 or 4.4747041) at the end of the time series.\n\n\n\n\n\nId_Number\nDaysRemoved\n\n\n\n\n707\n108\n\n\n709\n36\n\n\n710\n19",
    "crumbs": [
      "Data Cleaning"
    ]
  },
  {
    "objectID": "quarto/data_exploration.html#data-filtering",
    "href": "quarto/data_exploration.html#data-filtering",
    "title": "Data Cleaning",
    "section": "Data Filtering",
    "text": "Data Filtering\nNow that we have removed data that we know contain errors, we can start to look for less obvious sources of errors. The SDLfilter package has two functions, dupfilter and ddfilter, that remove data duplicates and unlikely points, respectively.\nFirst let’s use dupfilter to remove duplicate data points with the same date and time.\n\nsdl_dup &lt;- SDLfilter::dupfilter(sdl_musk, \n                                step.time = 7,\n                                conditional = TRUE)\n\n\ndupfilter_exact removed 3 of 14065 locations\ndupfilter_qi removed 0 of 14062 locations\ndupfilter_time removed 31 of 14062 locations\ndupfilter_space removed 0 of 14031 locations\n\nInput data: 14065 locations\nFiltered data: 14031 locations\ndupfilter removed 34 locations (0.24% of original data)\n\n\nNext we’ll use ddfilter to filter points based on speed and turning angles between consecutive points. To use this function, we need to estimate the maximum reasonable speed between two consecutive locations. The vmax function maps a gamma distribution to the observed speeds and estimates the maximum speed as the value with a cumulative probability of 0.999.\n\nvmax &lt;- SDLfilter::vmax(sdl_dup, prob = 0.999)\n\n\ndupfilter_exact removed 0 of 14031 locations\ndupfilter_qi removed 0 of 14031 locations\ndupfilter_time removed 0 of 14031 locations\ndupfilter_space removed 176 of 14031 locations\n\nInput data: 14031 locations\nFiltered data: 13855 locations\ndupfilter removed 176 locations (1.25% of original data)\n\n\nThe maximum linear speed (Vmax) was estimated using 13841 locations.\nVmax: 0.4891431 km/h\n\n\nWe will also estimate the maximum one-way linear speed of a loop trip. A loop trip is defined as a spatial departure and return involving a series of three or more consecutive points. The vmaxlp function also uses a gamma distribution to estimate this speed:\n\nvmaxlp &lt;- SDLfilter::vmaxlp(sdl_dup, prob = 0.999)\n\n\ndupfilter_exact removed 0 of 14031 locations\ndupfilter_qi removed 0 of 14031 locations\ndupfilter_time removed 0 of 14031 locations\ndupfilter_space removed 176 of 14031 locations\n\nInput data: 14031 locations\nFiltered data: 13855 locations\ndupfilter removed 176 locations (1.25% of original data)\n\n\nThe maximum one-way linear speed of a loop trip (vmaxlp) was estimated using \n180 Vlp from 90 loop trips.\nvmaxlp: 0.269 km/h\n\n\nNow we can filter our data using ddfilter. Locations are removed if one of following criteria are met: 1) speed from previous and to subsequent location both exceed vmax; 2) inner angle is less than a given threshold and speed from a previous or to a subsequent location exceeds vmaxlp. We will specify a turning angle of 14 degrees, as outlined in Bjørneraas et al. 2010.\n\nsdl_dd1 &lt;- SDLfilter::ddfilter(sdl_dup, qi = 5, \n                              vmax = vmax, vmaxlp = vmaxlp,\n                              ia = 14)\n\n\nddfilter_speed removed 39 of 14031 locations\nddfilter_loop removed 38 of 13992 locations\n\nInput data: 14031 locations\nFiltered data: 13954 locations\nddfilter removed 77 locations (0.55% of original data)\n\n\n\n\n\n\n\n\n\n\n\nThe filtered points appear non-randomly across the time series, which suggests that our speed thresholds were too small. Let’s increase vmax and vmaxlp to more conservative values of 2 km/h and 1 km/h, respectively.\n\nsdl_dd2 &lt;- SDLfilter::ddfilter(sdl_dup, qi = 5, \n                              vmax = 2, vmaxlp = 1,\n                              ia = 14)\n\n\nddfilter_speed removed 1 of 14031 locations\nddfilter_loop removed 1 of 14030 locations\n\nInput data: 14031 locations\nFiltered data: 14029 locations\nddfilter removed 2 locations (0.01% of original data)\n\n\n\n\n\n\n\n\n\n\n\nThat seems to do a better job of only removing the most extreme points.",
    "crumbs": [
      "Data Cleaning"
    ]
  },
  {
    "objectID": "quarto/data_exploration.html#post-deployment-bias",
    "href": "quarto/data_exploration.html#post-deployment-bias",
    "title": "Data Cleaning",
    "section": "Post-deployment Bias",
    "text": "Post-deployment Bias\nLastly, we will remove any points collected within 24 hours of collar deployments to remove the immediate effects of capture and handling.\n\n\n\n\n\nId_Number\ncollar_deployed\n\n\n\n\n708\n2009-02-07 15:00:00\n\n\n7010\n2009-02-07 14:19:00\n\n\n7013\n2009-02-07 11:55:00\n\n\n7012\n2009-02-06 12:52:00\n\n\n7011\n2009-01-28 15:02:00\n\n\n710\n2008-01-18 16:29:00\n\n\n709\n2008-01-18 14:50:00\n\n\n7080\n2007-11-14 13:21:00\n\n\n707\n2007-11-14 10:50:00\n\n\n706\n2007-11-11 13:30:00",
    "crumbs": [
      "Data Cleaning"
    ]
  },
  {
    "objectID": "quarto/home_range.html",
    "href": "quarto/home_range.html",
    "title": "Home Range",
    "section": "",
    "text": "In this document, we will estimate home range size for collared muskoxen and look to compare range overlap and size across years and seasons.",
    "crumbs": [
      "Home Range"
    ]
  },
  {
    "objectID": "quarto/home_range.html#home-range",
    "href": "quarto/home_range.html#home-range",
    "title": "Home Range",
    "section": "Home Range",
    "text": "Home Range"
  },
  {
    "objectID": "quarto/home_range.html#estimating-movement-model",
    "href": "quarto/home_range.html#estimating-movement-model",
    "title": "Home Range",
    "section": "Estimating Movement Model",
    "text": "Estimating Movement Model\nBefore we can estimate home ranges for the collared muskoxen, we need to determine an appropriate movement model. To do this, we will use variograms. Our data has been updated to conform to Movebank naming conventions so that we can use the ctmm package.\n\nlibrary(ctmm)\nmusk_move &lt;- read.csv(here(\"data/raw/muskox_data/musk_collar_filt_movebank.csv\"))\nmusk_tel &lt;- as.telemetry(musk_move)[c(-2,-4,-5)]\n\nFirst we will plot empirical variograms for each collared muskoxen. Variograms are used to quantify spatial dependence between locations at different points in time. In general, as the time between locations increases, spatial dependence decreases. Variograms plot the semi-variance of distances between pairs of points separated by different time lags. At short time lags, these distances are very similar and the semi-variance is low. At large time lags, there is greater variability in the distances between points, so the semi-variance is high. Usually variograms will reach an asymptote in semi-variance that represents the time lag at which the animal is able to traverse their home range. For now we will leave out the muskoxen that had collar failures as they do not have enough data to estimate home ranges.\n\nmusk_var &lt;- lapply(musk_tel, variogram, CI=\"Gauss\", fast = TRUE)\nxlim &lt;- c(0,5 %#% \"day\")\n\n\nmap(musk_var, function(x) x %&gt;% as_tibble() %&gt;% mutate(id = x@info$identity)) %&gt;% \n  list_rbind() %&gt;%\n  mutate(level = 0.95,\n         ci.lower = SVF*qchisq((1-level)/2,DOF,lower.tail=TRUE)/DOF,\n         ci.upper = SVF*qchisq((1-level)/2,DOF,lower.tail=FALSE)/DOF) %&gt;%\n  group_by(id) %&gt;%\n  slice(seq(0.5*n())) %&gt;%\n  ungroup() %&gt;%\n  ggplot(aes(x = lag, y = SVF)) +\n  geom_linerange(aes(ymin = ci.lower, ymax = ci.upper), colour = \"grey\") +\n  geom_line() +\n  facet_wrap(~id, scales = \"free_y\") +\n  theme_bw()\n\n\n\n\n\n\n\n\nMost of these look fine, however for two of the longer time series (7011 and 7012) the semi-variance appears to reach an asymptote by the first year, but starts increasing again part way through the second year. If this behaviour is common, home range estimates may be biased even after a year’s worth of data. If muskoxen truly are nomadic and lack site fidelty, kernel density methods may not be appropriate (Silva et al., 2022).\nIt is also clear there are some issues with collars 708 and 7010. Closer inspection of the data reveals that, every 7 fixes, there is a longer 24 hour delay until the next fix. Currently, the model uses the median sampling interval (8 hours) to estimate the variogram. The variogram function allows is to specify more than one time interval (in our case, 8 and 24 hours) to progressively coarsen the variogram. We can also specify an interval-weighted algorithm to further improve the appearance of the variogram.\n\ndt &lt;- c(8,24) %#% \"hour\"\nmusk_var[[2]] &lt;- variogram(musk_tel[[2]], dt = dt, CI=\"Gauss\", fast = FALSE)\nmusk_var[[3]] &lt;- variogram(musk_tel[[3]], dt = dt, CI=\"Gauss\", fast = FALSE)\n\n\nmap(musk_var, function(x) x %&gt;% as_tibble() %&gt;% mutate(id = x@info$identity)) %&gt;% \n  list_rbind() %&gt;%\n  mutate(level = 0.95,\n         ci.lower = SVF*qchisq((1-level)/2,DOF,lower.tail=TRUE)/DOF,\n         ci.upper = SVF*qchisq((1-level)/2,DOF,lower.tail=FALSE)/DOF)  %&gt;%\n  group_by(id) %&gt;%\n  slice(seq(0.5*n())) %&gt;%\n  ungroup() %&gt;%\n  ggplot(aes(x = lag, y = SVF)) +\n  geom_linerange(aes(ymin = ci.lower, ymax = ci.upper), colour = \"grey\") +\n  geom_line() +\n  facet_wrap(~id, scales = \"free_y\") +\n  theme_bw()\n\n\n\n\n\n\n\n\nThese look better. Collars 7011 and 7012 do not appear to reach an asymptote in semi-variance as lag increases, suggesting that these individuals are not range resident. 7010 has a somewhat bell-shaped curve. This can be indicative of distinct winter and summer grounds. However, given that muskoxen appear to have limited movement in the winter and the ~1-year time series for 7010 starts and ends in winter, it seems more likely that the wintering grounds from one year to the next happened to be close together.\nWe can diagnose these issues further by fitting a variety of custom variogram functions to our data using the ctmm.select function.\n\n### fist create a best guess set of parameters for the model\nmusk_var_mod &lt;- lapply(musk_var, variogram.fit, interactive = FALSE)\n#fit &lt;- mapply(function(x,y){ctmm.select(x,y,verbose = TRUE,cores = 3)},musk_tel,musk_var_mod)\n#saveRDS(fit, here(\"output/musk_var_fit.rds\"))\nfit &lt;- readRDS(here(\"output/musk_var_fit.rds\"))\nfor (i in 1:length(musk_var)){print(musk_var[[i]]@info$identity);print(summary(fit[,i])); plot(musk_var[[i]], CTMM = fit[,i], col.CTMM=c(\"red\",\"purple\",\"blue\", \"green\"),fraction=0.5,level=0.5);plot(musk_var[[i]], CTMM = fit[,i], col.CTMM=c(\"red\",\"purple\",\"blue\", \"green\"),xlim = xlim,,level=0.5)}\n\n[1] \"706\"\n                     ΔAICc ΔRMSPE (km)  DOF[area]\nOUF anisotropic    0.00000    2.077907   9.617055\nOUF               42.66530    1.890928   9.990823\nOU anisotropic    68.82166    2.245986   7.367132\nOUf anisotropic 1317.33573    0.000000 219.589031\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[1] \"708\"\n                    ΔAICc ΔRMSPE (km) DOF[area]\nOUF anisotropic    0.0000    1.244331  25.89534\nOUF              116.7679    1.350865  18.22964\nOU anisotropic   198.9542    1.852910  21.97129\nOUf anisotropic 1030.2342    0.000000 285.96732\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[1] \"7010\"\n                    ΔAICc ΔRMSPE (km)  DOF[area]\nOUF anisotropic   0.00000    3.760725   8.090865\nOUF              57.73839    3.915642   8.109727\nOU anisotropic  149.18384    4.605075   4.914131\nOUf anisotropic 442.22301    0.000000 113.628816\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[1] \"7011\"\n                    ΔAICc ΔRMSPE (km)  DOF[area]\nOUF anisotropic    0.0000    5.483670   8.988154\nOUF              352.6867    6.712407   5.586937\nOU anisotropic   468.8016    6.491142   8.365915\nOUf anisotropic 2604.0344    0.000000 336.211689\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[1] \"7012\"\n                    ΔAICc ΔRMSPE (km)  DOF[area]\nOUF anisotropic    0.0000    3.607974  12.453842\nOUF              136.5556    4.887839  10.391674\nOU anisotropic   296.2989    4.133481   8.086789\nOUf anisotropic 2682.6031    0.000000 368.948403\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[1] \"7013\"\n                    ΔAICc ΔRMSPE (km)  DOF[area]\nOUF anisotropic    0.0000    3.001076  13.847073\nOUF              108.0571    2.462135  15.168212\nOU anisotropic   350.1016    3.654844   8.005831\nOUf anisotropic 2123.5205    0.000000 359.910030\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[1] \"7080\"\n                    ΔAICc ΔRMSPE (km) DOF[area]\nOUF anisotropic    0.0000    2.230820  23.94430\nOUF               73.9577    2.820220  21.23700\nOU anisotropic   216.7409    2.475281  15.64506\nOUf anisotropic 1048.6776    0.000000 278.59866\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThese look okay, but they aren’t capturing the short timescales well in all instances. This could be an issue with these individuals not being range resident, but it could also be related to telemetry error. To try to rectify this, we can attempt to fit models that account for potential error in the telemetry data.",
    "crumbs": [
      "Home Range"
    ]
  },
  {
    "objectID": "quarto/resource_selection.html",
    "href": "quarto/resource_selection.html",
    "title": "Resource selection",
    "section": "",
    "text": "musk_lc &lt;- musk_collar_filt %&gt;%\n  mutate(lc = extract(lc_2010_proj, musk_collar_filt, ID = FALSE)$value,\n         Group = ifelse(month&lt;5|month&gt;10,\"Occurrence\\nWinter (Nov - Apr)\",\"Occurrence\\nSummer (May - Sep)\")) %&gt;%\n  st_drop_geometry() %&gt;%\n  group_by(Group, lc) %&gt;%\n  summarise(n = n()) %&gt;%\n  group_by(Group) %&gt;%\n  mutate(freq = n/sum(n)) \n\n`summarise()` has grouped output by 'Group'. You can override using the\n`.groups` argument.\n\nlc_props &lt;- freq(lc_2010_proj) %&gt;%\n  mutate(freq = count/sum(count),\n         lc = factor(value, levels = levels(lc_atts$Classification)),\n         Group = \"Availability\") %&gt;%\n  select(Group, lc, freq)\n\n\nmusk_lc %&gt;%\n  select(-n) %&gt;%\n  bind_rows(lc_props) %&gt;%\n  filter(lc != \"Snow and Ice\") %&gt;%\n  ggplot(aes(x = lc, y = freq, fill = lc)) +\n  geom_col() +\n  facet_wrap(~Group) +\n  ylab(\"Proportion of GPS fixes\") +\n  labs(fill = \"Landcover\") +\n  xlab(\"Landcover\") +\n  scale_fill_manual(values = cols) +\n  theme_bw() +\n  theme(axis.text.x = element_blank(),\n        axis.ticks.x = element_blank())\n\n\n\n\n\n\n\n\n\n\n# A tibble: 12 × 2\n   month avg_sl\n   &lt;dbl&gt;  &lt;dbl&gt;\n 1     1 0.0968\n 2     2 0.0793\n 3     3 0.0873\n 4     4 0.0794\n 5     5 0.366 \n 6     6 0.956 \n 7     7 1.12  \n 8     8 0.852 \n 9     9 0.731 \n10    10 0.403 \n11    11 0.195 \n12    12 0.123"
  },
  {
    "objectID": "quarto/resource_selection.html#spatial-patterns",
    "href": "quarto/resource_selection.html#spatial-patterns",
    "title": "Resource selection",
    "section": "",
    "text": "musk_lc &lt;- musk_collar_filt %&gt;%\n  mutate(lc = extract(lc_2010_proj, musk_collar_filt, ID = FALSE)$value,\n         Group = ifelse(month&lt;5|month&gt;10,\"Occurrence\\nWinter (Nov - Apr)\",\"Occurrence\\nSummer (May - Sep)\")) %&gt;%\n  st_drop_geometry() %&gt;%\n  group_by(Group, lc) %&gt;%\n  summarise(n = n()) %&gt;%\n  group_by(Group) %&gt;%\n  mutate(freq = n/sum(n)) \n\n`summarise()` has grouped output by 'Group'. You can override using the\n`.groups` argument.\n\nlc_props &lt;- freq(lc_2010_proj) %&gt;%\n  mutate(freq = count/sum(count),\n         lc = factor(value, levels = levels(lc_atts$Classification)),\n         Group = \"Availability\") %&gt;%\n  select(Group, lc, freq)\n\n\nmusk_lc %&gt;%\n  select(-n) %&gt;%\n  bind_rows(lc_props) %&gt;%\n  filter(lc != \"Snow and Ice\") %&gt;%\n  ggplot(aes(x = lc, y = freq, fill = lc)) +\n  geom_col() +\n  facet_wrap(~Group) +\n  ylab(\"Proportion of GPS fixes\") +\n  labs(fill = \"Landcover\") +\n  xlab(\"Landcover\") +\n  scale_fill_manual(values = cols) +\n  theme_bw() +\n  theme(axis.text.x = element_blank(),\n        axis.ticks.x = element_blank())\n\n\n\n\n\n\n\n\n\n\n# A tibble: 12 × 2\n   month avg_sl\n   &lt;dbl&gt;  &lt;dbl&gt;\n 1     1 0.0968\n 2     2 0.0793\n 3     3 0.0873\n 4     4 0.0794\n 5     5 0.366 \n 6     6 0.956 \n 7     7 1.12  \n 8     8 0.852 \n 9     9 0.731 \n10    10 0.403 \n11    11 0.195 \n12    12 0.123"
  },
  {
    "objectID": "quarto/movement_patterns.html#defining-seasons",
    "href": "quarto/movement_patterns.html#defining-seasons",
    "title": "Movement Patterns",
    "section": "Defining Seasons",
    "text": "Defining Seasons\nWe can use snow depth data from the SnowModel project to look at how snow depth impacts step lengths\n\nsnowdepth_mean %&gt;%  \n  mutate(month = month(date)) %&gt;%\n  ggplot(aes(x=date, y=snow_depth, colour = factor(month), group = 1)) + \n  geom_line(linewidth = 2) +  \n  ylab(\"Average snow depth (m)\") +  \n  xlab(\"Date\") +   \n  theme_bw() \n\n\n\n\n\n\n\n\nClearly there are large changes in snow depth across seasons. Let’s plot snow depth against step lengths to see how they match up.\n\nmusk_snow &lt;- musk_collar_filt %&gt;%\n  mutate(date = as.Date(datetime)) %&gt;%\n  left_join(snowdepth_mean)\n\nmusk_snow %&gt;%\n  filter(pTime == 8, !is.na(snow_depth)) %&gt;%\n  group_by(snow_depth) %&gt;%\n  summarise(mean = mean(pDist),\n            lower = quantile(pDist,0.05),\n            upper = quantile(pDist,0.95)) %&gt;%\n  ggplot(aes(x=snow_depth, y = mean)) +\n  geom_pointrange(aes(ymin=lower, ymax=upper)) +\n  ylab(\"Step length (km)\") +\n  xlab(\"Snow depth (m)\") +\n  theme_bw()\n\n\n\n\n\n\n\n\nBased on this graph, step lengths decrease with increasing snow depth, as expected. The relationship appears to be exponential as well, with changes in step length becoming smaller as step length becomes smaller. Let’s plot our step length time series again but with colours representing 0.05 m bins of snow depth.\n\n\n\n\n\n\n\n\n\nIt looks like once snow is deeper than ~0.1 m on average, muskox movement decreases well beyond the typical summer step lengths. Of note in the winter of 2010-2011, the snow is especially deep for an extended period of time and step lengths are at their lowest.\nTo define seasons, let’s use a cut-off of 0.1 m snow depth. We’ll define the start of winter as the first three successive days with snow depth &gt;=0.1 m and the end of winter as the first three successive days with snow depth &lt;=0.1 m.\n\n\n\n\n\nyear\nstart_summer\nstart_winter\nlength_summer\nlength_winter\n\n\n\n\n2007\n2007-05-20\n2007-10-11\n144\n214\n\n\n2008\n2008-05-12\n2008-10-25\n166\n193\n\n\n2009\n2009-05-06\n2009-11-18\n196\n159\n\n\n2010\n2010-04-26\n2010-11-04\n192\n199\n\n\n2011\n2011-05-22\n2011-10-19\n150\n217\n\n\n2012\n2012-05-23\n2012-09-11\n111\nNA\n\n\n\n\n\nWe could also look at the movement trajectories of muskoxen at the transitions between seasons to decide on cutoffs specific to each individual. Let’s plot the locations of individual muskoxen for each winter, including the transition months of Sept/Oct and Apr/May\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nIt is clear from these plots that muskoxen tend to head to their winter range once snow starts to accumulate on the ground and leave that range when the snow melts. We can use interactive maps to pinpoint the dates when individuals arrive and leave their winter range. The winter season, along with the transition fall and spring seasons are indicated with different colours.",
    "crumbs": [
      "Movement Patterns"
    ]
  },
  {
    "objectID": "quarto/movement_patterns.html#muskox-calving",
    "href": "quarto/movement_patterns.html#muskox-calving",
    "title": "Movement Patterns",
    "section": "Muskox Calving",
    "text": "Muskox Calving\nMovement behaviour in spring may be related to calving. Previous studies in Greenland have shown that muskoxen benefit from earlier spring green-up (Eikelenboom et al., 2021), so muskoxen may be able to alter their movement behaviour depending on green-up timing. In 2008 and 2009, surveys were flown to relocate collared muskoxen to see if they were accompanied by calves. We can plot these data on graphs of step lengths in the spring to investigate how approximate calving dates impact movement.\n\n\n\n\n\n\n\n\n\nComparing the graphs of muskoxen that were observed to be accompanied by a calf to those that were not, there does not appear to be a major difference in the general trend for step lengths. 7013 in 2009 is the only trajectory to show a sudden decrease in step lengths that resembles those used to determine calving dates for caribou (Bonar et al., 2018; DeMars et al., 2013), but this signal is not present for any of the other muskoxen. For most muskoxen, there is a marked increase in step length in mid-May, but this does not appear to be related to calving dates. The survey data shows that in almost all spring surveys (April onwards), the collared muskoxen were in groups consisting of other females with calves. Only 7010 in 2009 was in a group that wasn’t observed to contain calves until the June survey. I am not sure if these observations",
    "crumbs": [
      "Movement Patterns"
    ]
  },
  {
    "objectID": "quarto/home_range.html#createing-auto-correlated-kernel-density-estimates",
    "href": "quarto/home_range.html#createing-auto-correlated-kernel-density-estimates",
    "title": "Home Range",
    "section": "Createing Auto Correlated Kernel Density Estimates",
    "text": "Createing Auto Correlated Kernel Density Estimates\nWe can use kernel density estimates that account for these underlying movement models using the akde function.\n\nbest_fit &lt;- fit[1,]\nakde &lt;- mapply(function(x,y){akde(x,y)},musk_tel,best_fit)\nEXT &lt;- lapply(akde, extent, level=0.95)\nfor(i in 1:length(akde)){plot(musk_tel[[i]],UD=akde[[i]],\n                              xlim=EXT[[i]]$x,ylim=EXT[[i]]$y);\n  title(names(musk_tel)[[i]])}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nmap(akde, function(x){as_tibble(summary(x)$CI)}) %&gt;%\n  list_rbind() %&gt;%\n  set_names(c(\"lower\",\"mean\",\"upper\")) %&gt;%\n  mutate(id = factor(names(musk_tel), levels = names(musk_tel)),\n         mean = round(mean),\n         lower = round(lower),\n         upper = round(upper)) %&gt;%\n  select(id,lower,mean,upper) %&gt;%\n  ggplot(aes(x = id, y = mean)) +\n  geom_pointrange(aes(ymin = lower, ymax = upper)) +\n  ylab(\"Home range size (km2)\") +\n  xlab(\"Muskox ID\") +\n  theme_bw()\n\n\n\n\n\n\n\nmusk_move %&gt;%\n  filter(individual.local.identifier %in% names(musk_tel)) %&gt;%\n  mutate(date = as.Date(timestamp),\n         id = factor(individual.local.identifier, levels = names(musk_tel))) %&gt;%\n  group_by(id) %&gt;%\n  summarise(days = max(date) - min(date)) %&gt;%\n  ggplot(aes(x = id, y = days)) +\n  geom_point(size = 2) +\n  theme_bw()",
    "crumbs": [
      "Home Range"
    ]
  },
  {
    "objectID": "quarto/home_range.html#creating-auto-correlated-kernel-density-estimates",
    "href": "quarto/home_range.html#creating-auto-correlated-kernel-density-estimates",
    "title": "Home Range",
    "section": "Creating Auto Correlated Kernel Density Estimates",
    "text": "Creating Auto Correlated Kernel Density Estimates\nWe can use kernel density estimates that account for these underlying movement models using the akde function. We will also plot the telemetry points and colour them by day in order to understand when nomadic/dispersal events occur.\n\nbest_fit &lt;- fit[1,]\nakde &lt;- mapply(function(x,y){akde(x,y)},musk_tel,best_fit)\nEXT &lt;- lapply(akde, extent, level=0.95)\nfor(i in 1:length(akde)){\n  COL &lt;- color(musk_tel[[i]],by='time')\n  plot(musk_tel[[i]],UD=akde[[i]],\n       xlim=EXT[[i]]$x,ylim=EXT[[i]]$y,\n       col = COL, lwd=4);\n  title(names(musk_tel)[[i]])\n  }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFor the most part, the home range estimates look pretty good, but there are some concerning aspects with clusters of points that look like they represent dispersal events. 706, 7011, 7012, and 7013 all have periods of time (usually at the start or end of the time series) where they moved away from the core home range area. I’m not sure if these are concerning, but some of the odd variograms would suggest they are.\nAnother thing to consider is that for some muskoxen, there appears to be some periodicity in their movement, which affects the home rnage estimates. 708 is a good example where the semi-variance decreases at certain times leading to an underestimated variogram model. This causes the fairly conservative home range estimate.\nLastly, these models don’t account for barrier to muskox movement. 7080 in particular has a lake in its home range that it travles around. This is probably why the home range estimate is split into different sections despite the variogram suggesting a range resident individual.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThere does not appear to be a strong relationship between the days that a collar was active and the size of the home range. The muskox with the second most number of days has the highest home range estimate, but the muskox with the least amount of days has the second highest estimate.\nThe range of home range sizes overlaps with a study conducted for 11 muskoxen in Bathhurst, Devon, and Cornwallis (233 - 2494 km2; Anderson and Ferguson, 2016). They used minimum convext polygons with up to three years of data for each muskox.",
    "crumbs": [
      "Home Range"
    ]
  },
  {
    "objectID": "quarto/home_range.html#seasonal-ranges",
    "href": "quarto/home_range.html#seasonal-ranges",
    "title": "Home Range",
    "section": "Seasonal Ranges",
    "text": "Seasonal Ranges\n\nmusk_season &lt;- readRDS(here(\"data/processed/musk_season.rds\"))",
    "crumbs": [
      "Home Range"
    ]
  },
  {
    "objectID": "quarto/seasonal_range.html",
    "href": "quarto/seasonal_range.html",
    "title": "Seasonal Range",
    "section": "",
    "text": "Using Brownian Bridge Movement Model from the adehabitatHR package to estimate seasonal ranges for each muskoxen. Summer and winter/calving are separated based on presence of snow and movement behaviours (see Movement Patterns). First let’s look at how long each season is for each muskoxen.\n\nmusk_season_length &lt;- musk_season %&gt;%\n  mutate(date = as.Date(datetime),\n         year_min = ifelse(season==\"Winter\"&month&lt;=5,year-1,year),\n         season = factor(season, \n                         levels = c(\"Summer\", \"Winter\", \"Calving\"))) %&gt;%\n  drop_na(season) %&gt;%\n  group_by(Id_Number, year_min, season) %&gt;%\n  mutate(seas_length = max(date)-min(date)) %&gt;%\n  ungroup() \n\nmusk_season_length %&gt;%\n  sf::st_drop_geometry() %&gt;%\n  distinct(Id_Number, year_min, season, seas_length) %&gt;%\n  ggplot(aes(x = Id_Number, y = seas_length, colour = factor(year_min))) +\n  geom_point(size = 3) +\n  geom_hline(\n    data = tibble(season = factor(c(\"Summer\", \"Winter\", \"Calving\")),\n                    y = c(120,90,30)),\n    aes(yintercept = y)) +\n  facet_wrap(~season)\n\n\n\n\n\n\n\n\nSome seasons are pretty short, due to the season overlapping the start or end of the monitoring period for that individuals. Let’s start by setting a cut-off for each season to be included in this analysis. Since muskoxen are moving around a lot in the summer, we’ll specify that we want at least four months of data (120 days). Summer usually goes from mid-May to end of October, so this cut-off assumes we have locations for roughly 80% of the period. Muskoxen are moving around less during the winter and calving seasons, so we will use cutoff of three and one month(s) (90 and 30 days). Winter typically lasts from end of October to our cutoff of April 1st and calving goes until mid May. This ensures roughly 60% of the season is included for winter and calving. Later we’ll compare different lengths of data to see the effect on home range estimates.\n\nmusk_collar_seas &lt;- musk_season_length %&gt;%\n  mutate(range_id = str_c(Id_Number,\"_\",year_min,\"_\",season)) %&gt;%\n  group_by(range_id) %&gt;%\n  filter(season == \"Calving\"&seas_length &gt;= 30|\n           season == \"Winter\"&seas_length &gt;= 90|\n           season == \"Summer\"&seas_length &gt;= 120) %&gt;%\n  ungroup() %&gt;%\n  mutate(range_id = factor(range_id)) %&gt;%\n  arrange(range_id)\n\nxy &lt;- musk_collar_seas %&gt;%\n  sf::st_transform(\"+proj=utm +zone=9\") %&gt;%\n  sf::st_coordinates()\nmusk_ltraj &lt;- adehabitatLT::as.ltraj(xy = xy, date = musk_collar_seas$datetime, id = musk_collar_seas$range_id)\n\nOur first step towards creating seasonal home ranges is to determine GPS accuracy using stationary GPS data. We can use data from collar 707 as this collar was confirmed to have released early. We will calculate the standard deviation of the euclidean distances to estimate GPS accuracy. This will be used as the sig2 parameter in our models and can be used to help estimate the other model parameter, sig1, which is related to home range size.\nWe can then fit movement models for each muskox for each season and estimate utilization distributions. From these distributions we can compare size and overlap between seasons, years, and muskoxen.\nBelow we plot an example seasonal range as well as a comparison between 90% seasonal ranges and 50% core seasonal ranges for each season.\n\nsig2 &lt;- musk_collar_cal %&gt;%\n  sf::st_transform(\"+proj=utm +zone=9\") %&gt;%\n  filter(Id_Number == 707) %&gt;%\n  mutate(x = sf::st_coordinates(geometry)[,1],\n         y = sf::st_coordinates(geometry)[,2]) %&gt;%\n  st_drop_geometry() %&gt;%\n  group_by(Id_Number) %&gt;%\n  ### calculate distances to estimate euclidean standard deviation (telemetry error)\n  mutate(mean_x = mean(x),\n         mean_y = mean(y),\n         distance = sqrt((x-mean_x)^2+(y-mean_y)^2)) %&gt;%\n  summarise(sd = sd(distance)) %&gt;%\n  pull(sd) %&gt;%\n  mean()\n\nsig1 &lt;- liker(musk_ltraj, \n              sig2 = sig2, \n              rangesig1 = c(0.1,20),\n              plotit = FALSE)\n\n\n# bbox &lt;- musk_collar_seas %&gt;%\n#   sf::st_transform(\"+proj=utm +zone=9\") %&gt;%\n#   mutate(x = sf::st_coordinates(geometry)[,1],\n#          y = sf::st_coordinates(geometry)[,2]) %&gt;%\n#   st_drop_geometry() %&gt;%\n#   group_by(range_id) %&gt;%\n#   summarise(xmin = min(x),\n#          xmax = max(x),\n#          ymin = min(y),\n#          ymax = max(y)) \n# \n# sp_pixels = list()\n# for(i in 1:nrow(bbox)){\n#   coords &lt;- expand.grid(x = seq(bbox$xmin[i]-50,bbox$xmax[i]+10,100),\n#                       y = seq(bbox$ymin[i]-10,bbox$ymax[i]+10,100))\n#   sf_points &lt;- st_as_sf(coords, coords = c(\"x\", \"y\"), crs = \"+proj=utm +zone=9\")\n#   sp_points &lt;- as(sf_points, \"Spatial\")\n#   sp_pixels[[i]] &lt;- SpatialPixels(sp_points)\n# }\n\nmusk_bb &lt;- list()\nfor(i in 1:length(sig1)){\n  musk_bb[[i]] &lt;- kernelbb(musk_ltraj[i],\n                           sig1 = sig1[[i]]$sig1,\n                           sig2 = sig2,\n                           grid=100) \n}\n\nLet’s take a look at the contour plots for each individual to make sure they look okay:\n\n\nLoading basemap 'topographic' from map service 'osm'...\nUsing geom_raster() with maxpixels = 670375.\n\n\n\n\n\n\n\n\n\nLoading basemap 'topographic' from map service 'osm'...\nUsing geom_raster() with maxpixels = 523647.\n\n\n\n\n\n\n\n\n\nLoading basemap 'topographic' from map service 'osm'...\nUsing geom_raster() with maxpixels = 365390.\n\n\n\n\n\n\n\n\n\nLoading basemap 'topographic' from map service 'osm'...\nUsing geom_raster() with maxpixels = 365390.\n\n\n\n\n\n\n\n\n\nLoading basemap 'topographic' from map service 'osm'...\nUsing geom_raster() with maxpixels = 557904.\n\n\n\n\n\n\n\n\n\nLoading basemap 'topographic' from map service 'osm'...\nUsing geom_raster() with maxpixels = 748800.\n\n\n\n\n\n\n\n\n\nLoading basemap 'topographic' from map service 'osm'...\nUsing geom_raster() with maxpixels = 532396.\n\n\n\n\n\n\n\n\n\nThese look reasonable. Let’s also plot the seasonal range sizes to compare between individuals and years:",
    "crumbs": [
      "Seasonal Range"
    ]
  },
  {
    "objectID": "quarto/home_range.html#incorporating-error",
    "href": "quarto/home_range.html#incorporating-error",
    "title": "Home Range",
    "section": "Incorporating Error",
    "text": "Incorporating Error\nWe will use location information for the collar 707, which had its release mechanism triggered early. Since this collar was stationary once it was released from the animal, we can use deviations from its average position to estimate telemetry error. This will partially account for instances where the muskox appeared to have moved between successive time stamps, but really didn’t or instances where the muskox appeared to move between successive time stamps, but really didn’t.\n\nmusk_collar_cal &lt;- read.csv(here(\"data/raw/muskox_data/musk_collar_cal_movebank.csv\"))\nmusk_cal &lt;- as.telemetry(musk_collar_cal)\n\nUERE &lt;- uere.fit(musk_cal)\nuere(musk_tel) &lt;- UERE\nmusk_var_mod_err &lt;- lapply(musk_tel, ctmm.guess, interactive = FALSE, CTMM=ctmm(error=TRUE))\nmusk_var_mod_err[[2]] &lt;- ctmm.guess(musk_tel[[2]], interactive = FALSE, CTMM=ctmm(error=TRUE, dt = dt))\n\nplot(musk_cal[[1]])\n\n\n\n\n\n\n\n\nWe can now rerun our original movement model selection process while incorporating the error model estimated above. Let’s plot the model results again, this time comparing the top models with those that did not have telemetry errors accounted for.\n\n\n[1] \"706\"\n\n\n                           ΔAICc ΔRMSPE (km)  DOF[area]\nOUF anisotropic error    0.00000   2.2344179   9.617917\nOUF error               42.65746   2.0474638   9.991301\nOU anisotropic error    68.86482   2.4026258   7.366628\nOU error               107.91054   2.2263595   7.684893\nOUf anisotropic error 1316.99896   0.1567056 219.546373\nOUf error             1367.62263   0.0000000 228.148524\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[1] \"708\"\n\n\n                          ΔAICc ΔRMSPE (km) DOF[area]\nOUF anisotropic error    0.0000   1.2443120  25.89589\nOU anisotropic error   116.8106   1.3508841  18.22860\nOUF error              198.9487   1.8528991  21.97189\nOU error               325.4510   1.9797853  15.30454\nOUf anisotropic error 1029.9538   0.0000000 285.93097\nOUf error             1268.4792   0.4381442 282.14732\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[1] \"7010\"\n\n\n                          ΔAICc ΔRMSPE (km)  DOF[area]\nOUF anisotropic error   0.00000   3.7607686   8.090526\nOUF error              57.72832   3.9154332   8.110248\nOU anisotropic error  149.19731   4.6047100   4.914693\nOU error              211.55879   4.5896619   4.985999\nOUf anisotropic error 442.14512   0.0000000 113.619823\nOUf error             497.21636   0.2162585 112.606598\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[1] \"7011\"\n\n\n                           ΔAICc  ΔRMSPE (km)   DOF[area]\nOUF anisotropic error     0.0000 2.194838e+00    8.989618\nOU anisotropic error    352.7649 3.423462e+00    5.587907\nOUF error               468.7999 3.202627e+00    8.366086\nOU error                854.4724 4.413170e+00    5.282838\nOUf anisotropic error 27860.7070 2.326091e-07 2789.993767\nOUf error             30005.0189 0.000000e+00 2789.999385\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[1] \"7012\"\n\n\n                          ΔAICc ΔRMSPE (km)  DOF[area]\nOUF anisotropic error    0.0000   3.6080627  12.453757\nOUF error              136.5608   4.8879238  10.392073\nOU anisotropic error   296.3918   4.1337411   8.085986\nOU error               476.4013   5.8450604   6.302248\nOUf anisotropic error 2682.0341   0.0000000 368.899939\nOUf error             2824.9064   0.6804765 379.614187\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[1] \"7013\"\n\n\n                          ΔAICc ΔRMSPE (km)  DOF[area]\nOUF anisotropic error    0.0000   3.2654029  13.848277\nOUF error              108.0515   2.7264739  15.168750\nOU anisotropic error   350.2036   3.9191996   8.005993\nOU error               445.6725   3.3786391   8.682609\nOUf anisotropic error 2123.0274   0.2645425 359.847800\nOUf error             2205.6538   0.0000000 383.552354\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[1] \"7080\"\n\n\n                           ΔAICc ΔRMSPE (km) DOF[area]\nOUF anisotropic error    0.00000   2.2307869  23.94462\nOUF error               73.95151   2.8201863  21.23734\nOU anisotropic error   216.76331   2.4752629  15.64489\nOU error               278.57094   3.0511870  14.20347\nOUf anisotropic error 1048.55323   0.0000000 278.58286\nOUf error             1195.70277   0.4189131 276.36127\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nIt appears as though the incorporation of the error model has not made any significant improvements to the fit of the variograms. To further investigate whether we can live with these erorrs, lets try to simulate new data based on these models and compare how well the empirical variograms for the real and simulated data match up with the modelled variograms.",
    "crumbs": [
      "Home Range"
    ]
  },
  {
    "objectID": "quarto/home_range.html#simulating-variograms",
    "href": "quarto/home_range.html#simulating-variograms",
    "title": "Home Range",
    "section": "Simulating Variograms",
    "text": "Simulating Variograms\nTo illustrate the variability of empirical variograms over long time periods, let’s simulate new data based on the best fitted models.\n\n\n[1] \"706\"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[1] \"708\"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[1] \"7010\"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[1] \"7011\"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[1] \"7012\"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[1] \"7013\"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[1] \"7080\"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAt large time scales, the modelled variogram does not appear to match up very well against the empirical variograms of the simulated and observed data. This is because the errors in the variograms (difference between modelled and empirical) are autocorrelated. Small perturbations are carried forward and can add up over time, but these are not necessarily a bad thing for fitting our model.\nIn addition, as the time lag increase, so to does our uncertainty about the estimated semi-variance because larger time lags have fewer pairs of data points to estimate the semi-variance. We have the most certainty at short time lags because we have many pairs of data to estimate uncertainty. It appears as though the simulated variogram is better represented by our current model.",
    "crumbs": [
      "Home Range"
    ]
  },
  {
    "objectID": "quarto/home_range.html#subseting-data",
    "href": "quarto/home_range.html#subseting-data",
    "title": "Home Range",
    "section": "Subseting Data",
    "text": "Subseting Data\nGiven that the start and end of the sampling period for each muskox can bias the end of the empirical variogram (the longest time lags will be solely based on the distances between the first and last locations), it may be necessary to subset some of the relocations. In particular, many sampling periods start and end in the winter when muskoxen are stationary. If overwintering locations at the start and end happen to be nearby, the variogram will experience a dip at the end and vice versa if they happen to be far apart. To limit the chance of this happening, lets ensure that sampling periods start or end in the summer\n\nmusk_move_sub &lt;- musk_move %&gt;%\n  mutate(timestamp = as.POSIXct(timestamp)) %&gt;%\n  filter(\n    individual.local.identifier == 706&\n      timestamp&gt;=as.POSIXct(\"2008-05-05\")|\n    individual.local.identifier == 708&\n      timestamp&gt;=as.POSIXct(\"2009-05-09\")|\n    individual.local.identifier == 7010&\n      timestamp&gt;=as.POSIXct(\"2009-05-15\")|\n    individual.local.identifier == 7011&\n      timestamp&lt;=as.POSIXct(\"2011-09-28\")|    \n    individual.local.identifier == 7012&\n      timestamp&gt;=as.POSIXct(\"2009-05-19\")|\n    individual.local.identifier %in%c(7013,7080))\n  \nmusk_tel_sub &lt;- as.telemetry(musk_move_sub)\n\nmusk_var_sub &lt;- lapply(musk_tel_sub, variogram, CI=\"Gauss\", fast = TRUE)\ndt &lt;- c(8,24) %#% \"hour\"\nmusk_var_sub[[2]] &lt;- variogram(musk_tel_sub[[2]], dt = dt, CI=\"Gauss\", fast = FALSE)\nmusk_var_sub[[3]] &lt;- variogram(musk_tel_sub[[3]], dt = dt, CI=\"Gauss\", fast = FALSE)\n\n\n### fist create a best guess set of parameters for the model\nmusk_sub_mod &lt;- lapply(musk_var_sub, variogram.fit, interactive = FALSE)\n# fit3 &lt;- mapply(function(x,y){ctmm.select(x,y,verbose = TRUE,cores = 3)},musk_tel_sub,musk_sub_mod)\n# saveRDS(fit3, here(\"output/musk_sub_fit.rds\"))\nfit3 &lt;- readRDS(here(\"output/musk_sub_fit.rds\"))\nfor (i in 1:length(musk_var)){print(musk_var_sub[[i]]@info$identity);print(summary(fit3[,i])); plot(musk_var[[i]], CTMM = fit[,i], col.CTMM=c(\"red\",\"purple\",\"blue\", \"green\"),xlim = xlim,,level=0.5);title(\"full dataset\");plot(musk_var_sub[[i]], CTMM = fit3[,i], col.CTMM=c(\"red\",\"purple\",\"blue\", \"green\"),xlim = xlim,,level=0.5); title(\"data subset\")}\n\n[1] \"706\"\n                    ΔAICc ΔRMSPE (km)  DOF[area]\nOUF anisotropic   0.00000    2.143457   8.800598\nOUF              28.26221    2.004529   9.024789\nOU anisotropic   44.22490    2.258183   6.992280\nOUf anisotropic 888.65792    0.000000 161.289082\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[1] \"708\"\n                   ΔAICc ΔRMSPE (km) DOF[area]\nOUF anisotropic   0.0000    1.231015  25.36386\nOUF             101.1670    1.353331  17.67646\nOU anisotropic  171.9603    1.824976  21.50742\nOUf anisotropic 844.0938    0.000000 258.06527\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[1] \"7010\"\n                    ΔAICc ΔRMSPE (km) DOF[area]\nOUF anisotropic   0.00000    5.283650  5.359900\nOUF              34.71975    6.097631  4.928991\nOU anisotropic   93.96447    6.865491  3.335552\nOUf anisotropic 319.64118    0.000000 83.851258\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[1] \"7011\"\n                    ΔAICc ΔRMSPE (km)  DOF[area]\nOUF anisotropic    0.0000    4.765042  10.583397\nOUF              368.0569    5.966762   6.069101\nOU anisotropic   452.3840    6.329158   9.043029\nOUf anisotropic 2253.1642    0.000000 322.782766\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[1] \"7012\"\n                    ΔAICc ΔRMSPE (km) DOF[area]\nOUF anisotropic    0.0000    2.700785  18.66284\nOUF              128.4660    3.630577  15.48266\nOU anisotropic   266.3699    3.226017  11.28586\nOUf anisotropic 2113.4678    0.000000 393.80406\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[1] \"7013\"\n                    ΔAICc ΔRMSPE (km)  DOF[area]\nOUF anisotropic    0.0000    3.001039  13.847962\nOUF              108.0549    2.462134  15.169075\nOU anisotropic   350.3208    3.655037   8.005003\nOUf anisotropic 2123.2222    0.000000 359.888433\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[1] \"7080\"\n                     ΔAICc ΔRMSPE (km) DOF[area]\nOUF anisotropic    0.00000    2.230868  23.94349\nOUF               73.95642    2.820264  21.23632\nOU anisotropic   216.81563    2.475390  15.64332\nOUf anisotropic 1048.54150    0.000000 278.57428\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThese look similar overall. The variogram for 7080 still appears to be not well matched at short lags. This could be due to the fact that 7080 traverses a lake that appears to fall in the middle of their home range, thus impacting the movement paths it takes",
    "crumbs": [
      "Home Range"
    ]
  }
]